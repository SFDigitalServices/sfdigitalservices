version: 2
jobs:
  build:
    branches:
      ignore:
        - gh-pages
        - /.*-static-ci/

    docker:
      - image: cibuilds/hugo:latest

    working_directory: ~/hugo

    environment:
      - SOURCE_BRANCH: main
      - TARGET_BRANCH: gh-pages

    steps:
      - checkout

      - run:
          name: Build and deploy
          command: ./.circleci/scripts/build-deploy-heroku.sh

